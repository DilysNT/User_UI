<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Hero Section Search</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .result { background: #f9f9f9; padding: 10px; margin: 10px 0; border-radius: 5px; }
        button { background: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        input, select { margin: 5px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .search-form { background: #e7f3ff; padding: 15px; border-radius: 8px; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Test Hero Section Search Functionality</h1>
        
        <div class="test-section">
            <h2>1. Test Search by Tour Name</h2>
            <div class="search-form">
                <label>T√™n tour:</label>
                <input type="text" id="tourName" placeholder="Nh·∫≠p t√™n tour...">
                <button onclick="testTourNameSearch()">T√¨m theo t√™n tour</button>
            </div>
            <div id="tourNameResult" class="result"></div>
        </div>

        <div class="test-section">
            <h2>2. Test Search by Filters</h2>
            <div class="search-form">
                <div>
                    <label>ƒêi·ªÉm ƒë·∫øn:</label>
                    <select id="destination">
                        <option value="">Ch·ªçn ƒëi·ªÉm ƒë·∫øn</option>
                        <option value="ƒê√† N·∫µng">ƒê√† N·∫µng</option>
                        <option value="H·∫° Long">H·∫° Long</option>
                        <option value="ƒê√† L·∫°t">ƒê√† L·∫°t</option>
                        <option value="H·ªì Ch√≠ Minh">H·ªì Ch√≠ Minh</option>
                        <option value="H√† N·ªôi">H√† N·ªôi</option>
                    </select>
                </div>
                <div>
                    <label>ƒêi·ªÉm xu·∫•t ph√°t:</label>
                    <select id="departure">
                        <option value="">Ch·ªçn ƒëi·ªÉm xu·∫•t ph√°t</option>
                        <option value="TP.H·ªì Ch√≠ Minh">TP.H·ªì Ch√≠ Minh</option>
                        <option value="H√† N·ªôi">H√† N·ªôi</option>
                        <option value="ƒê√† N·∫µng">ƒê√† N·∫µng</option>
                        <option value="C·∫ßn Th∆°">C·∫ßn Th∆°</option>
                        <option value="Nha Trang">Nha Trang</option>
                    </select>
                </div>
                <div>
                    <label>Ng√†y mong mu·ªën:</label>
                    <input type="date" id="startDate" min="2025-07-21">
                </div>
                <button onclick="testFilterSearch()">T√¨m theo b·ªô l·ªçc</button>
            </div>
            <div id="filterResult" class="result"></div>
        </div>

        <div class="test-section">
            <h2>3. Test API Endpoints</h2>
            <button onclick="testAPIs()">Test All APIs</button>
            <div id="apiResult" class="result"></div>
        </div>

        <div class="test-section">
            <h2>4. Expected Search URLs</h2>
            <div id="urlExamples" class="result">
                <h4>V√≠ d·ª• URL t√¨m ki·∫øm theo t√™n tour:</h4>
                <code>http://localhost:3000/search?tourName=Du%20l%E1%BB%8Bch%20H%E1%BA%A1%20Long</code>
                
                <h4>V√≠ d·ª• URL t√¨m ki·∫øm theo b·ªô l·ªçc:</h4>
                <code>http://localhost:3000/search?destination=ƒê√†%20L·∫°t&departure=TP.H·ªì%20Ch√≠%20Minh&startDateRange=2025-06-21&endDateRange=2025-08-21&preferredDate=2025-07-21</code>
            </div>
        </div>
    </div>

    <script>
        function testTourNameSearch() {
            const tourName = document.getElementById('tourName').value.trim();
            const resultDiv = document.getElementById('tourNameResult');
            
            if (!tourName) {
                resultDiv.innerHTML = '<div class="error">‚ùå Vui l√≤ng nh·∫≠p t√™n tour</div>';
                return;
            }
            
            // Simulate the search URL generation
            const searchURL = `http://localhost:3000/search?tourName=${encodeURIComponent(tourName)}`;
            
            resultDiv.innerHTML = `
                <div class="success">‚úÖ T√¨m ki·∫øm theo t√™n tour th√†nh c√¥ng!</div>
                <div><strong>T√™n tour:</strong> ${tourName}</div>
                <div><strong>URL:</strong> <a href="${searchURL}" target="_blank">${searchURL}</a></div>
                <div class="warning">üí° Ch·ª©c nƒÉng n√†y s·∫Ω t√¨m t·∫•t c·∫£ tour c√≥ t√™n ch·ª©a t·ª´ kh√≥a "${tourName}"</div>
            `;
        }

        function testFilterSearch() {
            const destination = document.getElementById('destination').value;
            const departure = document.getElementById('departure').value;
            const startDate = document.getElementById('startDate').value;
            const resultDiv = document.getElementById('filterResult');
            
            // Validate required fields
            if (!destination) {
                resultDiv.innerHTML = '<div class="error">‚ùå Vui l√≤ng ch·ªçn ƒëi·ªÉm ƒë·∫øn</div>';
                return;
            }
            
            if (!departure) {
                resultDiv.innerHTML = '<div class="error">‚ùå Vui l√≤ng ch·ªçn ƒëi·ªÉm kh·ªüi h√†nh</div>';
                return;
            }
            
            // Generate search parameters
            const searchParams = new URLSearchParams({
                destination: destination,
                departure: departure
            });
            
            // Add date range if start date is selected
            if (startDate) {
                const selectedDate = new Date(startDate);
                
                // Create ¬±1 month range
                const startRange = new Date(selectedDate);
                startRange.setMonth(startRange.getMonth() - 1);
                
                const endRange = new Date(selectedDate);
                endRange.setMonth(endRange.getMonth() + 1);
                
                searchParams.append('startDateRange', startRange.toISOString().split('T')[0]);
                searchParams.append('endDateRange', endRange.toISOString().split('T')[0]);
                searchParams.append('preferredDate', startDate);
            }
            
            const searchURL = `http://localhost:3000/search?${searchParams.toString()}`;
            
            resultDiv.innerHTML = `
                <div class="success">‚úÖ T√¨m ki·∫øm theo b·ªô l·ªçc th√†nh c√¥ng!</div>
                <div><strong>ƒêi·ªÉm ƒë·∫øn:</strong> ${destination}</div>
                <div><strong>ƒêi·ªÉm xu·∫•t ph√°t:</strong> ${departure}</div>
                ${startDate ? `<div><strong>Ng√†y mong mu·ªën:</strong> ${new Date(startDate).toLocaleDateString('vi-VN')}</div>` : ''}
                ${startDate ? `<div><strong>Kho·∫£ng t√¨m ki·∫øm:</strong> ¬±1 th√°ng (${new Date(new Date(startDate).setMonth(new Date(startDate).getMonth() - 1)).toLocaleDateString('vi-VN')} - ${new Date(new Date(startDate).setMonth(new Date(startDate).getMonth() + 1)).toLocaleDateString('vi-VN')})</div>` : ''}
                <div><strong>URL:</strong> <a href="${searchURL}" target="_blank">${searchURL}</a></div>
                <div class="warning">üí° Ch·ª©c nƒÉng n√†y s·∫Ω t√¨m tour theo ƒëi·ªÉm ƒë·∫øn, ƒëi·ªÉm xu·∫•t ph√°t v√† ng√†y kh·ªüi h√†nh linh ho·∫°t (¬±1 th√°ng)</div>
            `;
        }

        async function testAPIs() {
            const resultDiv = document.getElementById('apiResult');
            resultDiv.innerHTML = '<div>üîÑ ƒêang ki·ªÉm tra c√°c API...</div>';
            
            const apis = [
                { name: 'Tours API', url: 'http://localhost:5000/api/tours' },
                { name: 'Locations API', url: 'http://localhost:5000/api/locations' },
                { name: 'Departure Locations API', url: 'http://localhost:5000/api/departure-locations' }
            ];
            
            let results = [];
            
            for (const api of apis) {
                try {
                    const response = await fetch(api.url);
                    if (response.ok) {
                        const data = await response.json();
                        results.push(`<div class="success">‚úÖ ${api.name}: OK (${Array.isArray(data) ? data.length : 'data'} items)</div>`);
                    } else {
                        results.push(`<div class="error">‚ùå ${api.name}: HTTP ${response.status}</div>`);
                    }
                } catch (error) {
                    results.push(`<div class="warning">‚ö†Ô∏è ${api.name}: ${error.message} (using fallback data)</div>`);
                }
            }
            
            resultDiv.innerHTML = results.join('');
        }

        // Set default date to today
        document.getElementById('startDate').value = new Date().toISOString().split('T')[0];
        
        // Auto-test APIs on load
        window.onload = function() {
            testAPIs();
        };
    </script>
</body>
</html>
