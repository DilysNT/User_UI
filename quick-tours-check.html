<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Tours API Check</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .result { background: #f9f9f9; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #007bff; }
        .success { border-left-color: #28a745; background: #d4edda; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; font-size: 12px; max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Quick Tours API Check</h1>
        <div id="result">üîÑ Loading tours data...</div>
    </div>

    <script>
        async function checkTours() {
            const resultDiv = document.getElementById('result');
            
            try {
                const response = await fetch('http://localhost:5000/api/tours');
                const tours = await response.json();
                
                if (!Array.isArray(tours)) {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <h3>‚ùå Invalid Response</h3>
                            <pre>${JSON.stringify(tours, null, 2)}</pre>
                        </div>
                    `;
                    return;
                }
                
                // Quick analysis
                const total = tours.length;
                const sampleTour = tours[0];
                const fields = sampleTour ? Object.keys(sampleTour) : [];
                
                // Check for ƒê√† L·∫°t tours
                const daLatTours = tours.filter(tour => 
                    JSON.stringify(tour).toLowerCase().includes('ƒë√† l·∫°t')
                );
                
                // Check departure_location field
                const toursWithDeparture = tours.filter(t => t.departure_location);
                
                resultDiv.innerHTML = `
                    <div class="result success">
                        <h3>üìä Tours API Summary</h3>
                        <div><strong>Total tours:</strong> ${total}</div>
                        <div><strong>Tours with "ƒê√† L·∫°t":</strong> ${daLatTours.length}</div>
                        <div><strong>Tours with departure_location:</strong> ${toursWithDeparture.length}</div>
                        <div><strong>Available fields:</strong> ${fields.join(', ')}</div>
                    </div>
                    
                    ${daLatTours.length > 0 ? `
                        <div class="result success">
                            <h3>üéØ ƒê√† L·∫°t Tours Found</h3>
                            <pre>${JSON.stringify(daLatTours.slice(0, 2), null, 2)}</pre>
                        </div>
                    ` : `
                        <div class="result error">
                            <h3>‚ùå No ƒê√† L·∫°t Tours Found</h3>
                            <div>First 3 tours for comparison:</div>
                            <pre>${JSON.stringify(tours.slice(0, 3), null, 2)}</pre>
                        </div>
                    `}
                    
                    ${toursWithDeparture.length > 0 ? `
                        <div class="result">
                            <h3>üöó Sample Departure Locations</h3>
                            <div>Unique departure locations:</div>
                            <pre>${JSON.stringify([...new Set(toursWithDeparture.map(t => t.departure_location))], null, 2)}</pre>
                        </div>
                    ` : `
                        <div class="result error">
                            <h3>‚ö†Ô∏è No Departure Locations</h3>
                            <div>Tours don't have departure_location field</div>
                        </div>
                    `}
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h3>‚ùå API Error</h3>
                        <div><strong>Error:</strong> ${error.message}</div>
                    </div>
                `;
            }
        }
        
        checkTours();
    </script>
</body>
</html>
